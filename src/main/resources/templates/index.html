<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Spring Boot Payment Gateway</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
          crossorigin="anonymous">
</head>

<body>
<div class="container mt-5">
    <h1 class="mb-4">Spring Boot with Payment Gateway</h1>

    <table class="table table-borderless">
        <tr>
            <td>Name:</td>
            <td><input type="text" name="name" id="name" class="form-control" /></td>
        </tr>
        <tr>
            <td>Email:</td>
            <td>
                <input type="email" name="email" id="email" class="form-control" />
            </td>
        </tr>
        <tr>
            <td>Phone:</td>
            <td><input type="text" name="phone" id="phone" class="form-control" /></td>
        </tr>
        <tr>
            <td>Select Course:</td>
            <td>
                <select class="form-select" name="course" id="course">
                    <option selected disabled>Select course</option>
                    <option value="java">Java</option>
                    <option value="python">Python</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>Amount (INR):</td>
            <td>
                <input type="number" name="amount" id="amount" class="form-control" />
            </td>
        </tr>
        <tr>
            <td></td>
            <td>
                <button id="rzp-button1" type="button" class="btn btn-primary">Proceed to Pay</button>
            </td>
        </tr>
    </table>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
    async function createOrder() {
        console.log("Creating order...");

        const response = await fetch('http://localhost:8080/create-order', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                phno: document.getElementById('phone').value,
                course: document.getElementById('course').value,
                amount: document.getElementById('amount').value,
                currency: 'INR'
            })
        });

        const order = await response.json();
        console.log("Order created:", order);
        return order;
    }

    document.getElementById('rzp-button1').onclick = async function (e) {
        e.preventDefault();

        const order = await createOrder();

        const options = {
            key: "enter your razorpay keys ive created  by creating razorpay account its free ",
            amount: order.amount,
            currency: "INR",
            description: "Course Payment",
            order_id: order.razorPayOrderId,
            receipt: order.email,
            callback_url: "http://localhost:8080/handle-payment-callback",
            prefill: {
                name: order.name,
                email: order.email,
                contact: order.phno
            }
        };

        const rzp = new Razorpay(options);
        rzp.open();
    };
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
</body>

</html>
